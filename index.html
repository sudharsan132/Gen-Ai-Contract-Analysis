<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GenAI Legal Assistant ‚Äì Indian SMEs</title>

<!-- PDF.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>

<!-- DOCX -->
<script src="https://cdn.jsdelivr.net/npm/mammoth@1.6.0/mammoth.browser.min.js"></script>

<!-- PDF Export -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
body{
font-family:Segoe UI,Inter,sans-serif;
background:linear-gradient(135deg,#e6efff,#f5f9ff);
margin:0;padding:0
}
.container{max-width:1100px;margin:auto;padding:30px}
.card{
background:#fff;border-radius:16px;padding:30px;
box-shadow:0 15px 40px rgba(37,99,235,.2);
margin-bottom:25px
}
h1{color:#1e40af}
.upload{
border:2px dashed #2563eb;
padding:45px;text-align:center;
border-radius:14px;cursor:pointer
}
.upload:hover{background:#eef4ff}
button{
margin-top:20px;
background:linear-gradient(135deg,#2563eb,#1e40af);
color:#fff;border:none;
padding:14px 26px;border-radius:10px;
cursor:pointer;font-size:1rem
}
button:disabled{opacity:.5}
.metrics{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:20px}
.metric{
background:linear-gradient(135deg,#2563eb,#1e40af);
color:#fff;border-radius:12px;padding:20px;text-align:center
}
textarea{width:100%;min-height:130px;padding:15px;border-radius:10px}
table{width:100%;border-collapse:collapse}
th,td{padding:12px;border-bottom:1px solid #e5e7eb}
th{background:#eef2ff}
.hidden{display:none}
.status{color:#059669;font-weight:600;margin-top:10px}
.error{color:#dc2626;font-weight:600}
</style>
</head>

<body>
<div class="container">

<h1>‚öñÔ∏è GenAI Legal Assistant</h1>
<p>Client-side contract analysis (PDF / DOCX / TXT)</p>

<div class="card">
<div class="upload" id="uploadBox">
üìÑ Click or Drop Contract File
<input type="file" id="fileInput" accept=".pdf,.docx,.txt" hidden>
<div id="status" class="status"></div>
<div id="error" class="error"></div>
</div>
<button id="analyzeBtn" disabled>Analyze Contract</button>
</div>

<div id="results" class="hidden">

<div class="card">
<div class="metrics">
<div class="metric"><h2 id="clausesCount">-</h2>Clauses</div>
<div class="metric"><h2 id="highRiskCount">-</h2>High Risk</div>
<div class="metric"><h2 id="riskLevel">-</h2>Risk</div>
</div>
</div>

<div class="card">
<h3>Summary</h3>
<textarea id="summary" readonly></textarea>
</div>

<div class="card">
<h3>Clause Analysis</h3>
<table>
<thead>
<tr><th>Clause</th><th>Risk</th></tr>
</thead>
<tbody id="tableBody"></tbody>
</table>
</div>

<div class="card">
<button onclick="exportPDF()">Download Report PDF</button>
</div>

</div>

</div>

<script>
pdfjsLib.GlobalWorkerOptions.workerSrc =
'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';

let textContent='';

const uploadBox=document.getElementById('uploadBox');
const fileInput=document.getElementById('fileInput');
const status=document.getElementById('status');
const errorBox=document.getElementById('error');
const analyzeBtn=document.getElementById('analyzeBtn');

uploadBox.onclick=()=>fileInput.click();
fileInput.onchange=()=>handleFile(fileInput.files[0]);

async function handleFile(file){
status.textContent='';
errorBox.textContent='';
textContent='';
analyzeBtn.disabled=true;

if(!file) return;

status.textContent=`Loading ${file.name}...`;

try{
if(file.name.endsWith('.txt')){
textContent=await file.text();
}
else if(file.name.endsWith('.docx')){
const res=await mammoth.extractRawText({arrayBuffer:await file.arrayBuffer()});
textContent=res.value;
}
else if(file.name.endsWith('.pdf')){
textContent=await readPDF(file);
}
else{
throw 'Unsupported file';
}

if(textContent.trim().length<50) throw 'No readable text found';

status.textContent=`‚úî ${file.name} loaded successfully`;
analyzeBtn.disabled=false;

}catch(e){
errorBox.textContent='‚ùå Failed to read file';
console.error(e);
}
}

async function readPDF(file){
const buffer=await file.arrayBuffer();
const pdf=await pdfjsLib.getDocument(buffer).promise;
let fullText='';

for(let i=1;i<=pdf.numPages;i++){
const page=await pdf.getPage(i);
const content=await page.getTextContent();
const strings=content.items.map(it=>it.str).join(' ');
fullText+=strings+' ';
}
return fullText;
}

analyzeBtn.onclick=()=>{
const clauses=textContent.split(/[.!?]+/).filter(c=>c.length>40);
const high=clauses.filter(c=>/indemn|terminate|penalty|liabil|non-compete/i.test(c)).length;

document.getElementById('results').classList.remove('hidden');
document.getElementById('clausesCount').textContent=clauses.length;
document.getElementById('highRiskCount').textContent=high;
document.getElementById('riskLevel').textContent=high>1?'High':'Low';

document.getElementById('summary').value=
`Total Clauses: ${clauses.length}
High Risk Clauses: ${high}
Overall Risk: ${high>1?'High':'Low'}`;

document.getElementById('tableBody').innerHTML=
clauses.slice(0,10).map(c=>
`<tr><td>${c}</td><td>${/indemn|terminate/i.test(c)?'High':'Low'}</td></tr>`
).join('');
};

function exportPDF(){
const {jsPDF}=window.jspdf;
const pdf=new jsPDF();
pdf.text('Contract Analysis Report',20,20);
pdf.text(document.getElementById('summary').value,20,40);
pdf.save('contract-report.pdf');
}
</script>

</body>
</html>
